!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Gifffer",[],e):"object"==typeof exports?exports.Gifffer=e():t.Gifffer=e()}(this,function(){function t(t,e,i){var n=r.createElement("DIV"),d=i.getAttribute("class"),a=i.getAttribute("id");d?n.setAttribute("class",i.getAttribute("class")):null,a?n.setAttribute("id",i.getAttribute("id")):null,n.setAttribute("style","position:relative;cursor:pointer;");var l=r.createElement("DIV");l.setAttribute("class","gifffer-play-button"),l.setAttribute("style","width:"+o+"px;height:"+o+"px;border-radius:"+o/2+"px;background:rgba(0, 0, 0, 0.3);position:absolute;");var p=r.createElement("DIV");return p.setAttribute("style","width:0;height: 0;border-top:14px solid transparent;border-bottom:14px solid transparent;border-left:14px solid rgba(0, 0, 0, 0.5);position:absolute;left:26px;top:16px;"),l.appendChild(p),n.appendChild(l),i.parentNode.replaceChild(n,i),{c:n,p:l}}function e(t,e,i,r,o){var n=t.parentNode.offsetWidth,d=(t.parentNode.offsetHeight,r/o);return e.toString().indexOf("%")>0&&(e=parseInt(e.toString().replace("%","")),e=e/100*n,i=e/d),{w:e,h:i}}function i(i){var r,n,d,a,l,p,f,h,s,u,c,g,b=!1;r=i.getAttribute("data-gifffer"),a=i.getAttribute("data-gifffer-width"),l=i.getAttribute("data-gifffer-height"),p=i.getAttribute("data-gifffer-duration"),i.style.display="block",d=document.createElement("canvas"),u=!(!d.getContext||!d.getContext("2d")),a&&l&&u&&(s=t(a,l,i)),i.onload=function(){u&&(a=a||i.width,l=l||i.height,a>i.width&&(a=i.width),a!=i.width&&(l=a/i.width*i.height),s||(s=t(a,l,i)),n=s.c,f=s.p,g=e(n,a,l,i.width,i.height),n.addEventListener("click",function(){clearTimeout(c),b?(b=!1,n.appendChild(f),n.removeChild(h),n.appendChild(d),h=null):(b=!0,h=document.createElement("IMG"),h.setAttribute("style","width:"+g.w+"px;height:"+g.h+"px;"),h.setAttribute("data-uri",Math.floor(1e5*Math.random())+1),setTimeout(function(){h.src=r},0),n.removeChild(f),n.removeChild(d),n.appendChild(h),parseInt(p)>0&&(c=setTimeout(function(){b=!1,n.appendChild(f),n.removeChild(h),n.appendChild(d),h=null},p)))}),d.width=g.w,d.height=g.h,d.getContext("2d").drawImage(i,0,0,g.w,g.h),n.appendChild(d),f.style.top=g.h/2-o/2+"px",f.style.left=g.w/2-o/2+"px",n.setAttribute("style","position:relative;margin: 0 auto;cursor:pointer;width:"+g.w+"px;height:"+g.h+"px;"))},i.src=r}var r=document,o=60,n=function(){var t,e=0;for(t=r.querySelectorAll("[data-gifffer]");e<t.length;++e)i(t[e])};return n});