{% load humanize %}
{% load comments %}
{% load render_uploads %}

{% block additional_headers %}
  <script type="text/javascript" src="{{ STATIC_URL }}js/info_area.js"></script>
{% endblock %}

{% block content %}

    <table>
        <tr class="{% cycle 'darkTableRow' 'lightTableRow' %}">
            <td><img class="mini_task_img" src="{{ elaboration.challenge.image.url }}" width="32" height="32"></td>
            <td>{{ elaboration.challenge.title }}</td>
            <td class="timestamp" title="{{ elaboration.submission_time}}">{{ elaboration.submission_time|naturaltime }}</td>
            <td class="indicator_field">
				<div title="Great work" class="awesome_reviews indicator">{{ elaboration.get_awesome_reviews|length }}</div>
           	 	<div title="Good work" class="success_reviews indicator">{{ elaboration.get_success_reviews|length }}</div>
            	<div title="Barely acceptable work" class="fail_reviews indicator">{{ elaboration.get_fail_reviews|length }}</div>
            	<div title="Unacceptable" class="notry_reviews indicator">{{ elaboration.get_nothing_reviews|length }}</div>
            	<div title="Public comments" class="visible_comments indicator">{{ elaboration.get_visible_comments|length }}</div>
            	<div title="Private comments" class="invisible_comments indicator">{{ elaboration.get_invisible_comments|length }}</div></td>
        </tr>
    </table>
	
	<script>
		$(".indicator:contains('0')").addClass('zero_reviews');
		$(".timestamp").text($(".timestamp").text().replace(' days','d'));
		$(".timestamp").text($(".timestamp").text().replace(' day','d'));
		$(".timestamp").text($(".timestamp").text().replace(' hours','h'));
		$(".timestamp").text($(".timestamp").text().replace(' hour','h'));
		$(".timestamp").text($(".timestamp").text().replace(' weeks','w'));
		$(".timestamp").text($(".timestamp").text().replace(' week','w'));
		$(".timestamp").text($(".timestamp").text().replace(',',''));
		$(".timestamp").text($(".timestamp").text().replace(' ago',''));
	</script>

	<div class="elab_in_detail minElab" id="EiD" class="height:2em"><i class="fa fa-caret-square-o-down fa-2x klapp" onClick="if ($('#EiD').hasClass('minElab')) {$('#EiD').removeClass('minElab')} else {$('#EiD').addClass('minElab')}"></i> {{ elaboration.challenge.description|safe|urlizetrunc:30 }}</div>
	
    {% render_uploads elaboration %}

    {% if elaboration.elaboration_text|length != 0 %}
        <textarea id="editor_stack_rev">{{ elaboration.elaboration_text|safe }}</textarea>
    {% endif %}
    <div class="spacer"></div>

    <div class="spacer"></div>
    {% if elaboration %}
        {% render_multi_comment_list for elaboration %}
    {% endif %}

    <div class="spacer"></div>
    {% if reviews %}
        {% include "reviews.html" %}
        <div class="spacer"></div>
    {% endif %}

{% endblock %}